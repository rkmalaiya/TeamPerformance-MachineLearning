{
    "contents" : "teamdata <- read.csv(\"teamdata.csv\")\nteamdata_completeCases <- read.csv(\"teamdata_completeCases.csv\")\n\n## Find patterns of activity of each group\n\n# grouping data based on project\n\nif(!require(dplyr)) {\n  install.packages(\"dplyr\")\n  require(dplyr)\n}\nif(!require(plyr)) {\n  install.packages(\"plyr\")\n  require(plyr)\n}\nif(!require(ggplot2)) {\n  install.packages(\"ggplot2\")\n  require(ggplot2)\n}\n\n# Getting only Project-wise data\nteamdata.projectwise <- ddply(teamdata, ~ name ~ date, summarise,\n                              jira_count = sum(jira_count),\n                              svn_count = sum(svn_count),\n                              email_count = sum(email_count),\n                              jira_type = max(jira_type),\n                              jira_priority = max(jira_priority),\n                              votes = sum(votes),\n                              watches = sum(watches)\n)\n\npng(\"datapoints_distribution.png\", width = 1200, height = 786)\nplot(teamdata.projectwise[, c(-1, -2, -10)], main = \"Data-point distribution\")\ndev.off()\n\n# Trying Kmeans\n\nset.seed(12)\n\nfor(i in 7:12) {\n  \n  png(paste0(\"KmeansCluster_ForCenter_\",i,\".png\"), width = 1390, height = 732)\n  par(mfrow= c(3,3))\n  \n  teamdata.projectwise.km <- kmeans(teamdata.projectwise[, -(1:2)], centers = i, nstart = 3)\n  \n  teamdata.projectwise_cl <- mutate(teamdata.projectwise, cluster = teamdata.projectwise.km$cluster)\n  \n  with(teamdata.projectwise_cl, plot(x = name, cluster, xlab=\"Project Groups\", ylab = \"Clusters\",\n                                     main = paste0(\"Mean Distribution of Clusters(\",i,\" centers)\")))\n  \n  kmCenters <- as.data.frame(teamdata.projectwise.km$centers)\n  kmCenters <- mutate(kmCenters,cluster = row.names(kmCenters))\n  \n  lapply (names(kmCenters)[1:7], function(name) {  \n    pie(x = kmCenters[,name], \n        labels = kmCenters$cluster, main = paste0(\"Work Distribution of \",name,\" for each Cluster\"))  \n  })\n  dev.off()\n}\n\n# Lets assume 9 Centers for Kmeans makes most sense\nteamdata.projectwise.km <- kmeans(teamdata.projectwise[, -(1:2)], centers = 9, nstart = 3)\nteamdata.projectwise_cl <- mutate(teamdata.projectwise, cluster = teamdata.projectwise.km$cluster)\n\npng(\"Project-wise_distribution.png\", width = 1390, height = 732)\npar(mfrow= c(3,3))\nlapply(names(teamdata.projectwise_cl)[c(-1,-2,-10)], function(x) {\n  plot(teamdata.projectwise_cl[ ,x], teamdata.projectwise_cl$date, col = teamdata.projectwise_cl$project, xlab = x, ylab = \"Days\", main = paste(\"Project-wise distribution for\",x))\n  \n}) \ndev.off()\n\npng(\"Cluster-wise_distribution.png\", width = 1390, height = 732)\npar(mfrow= c(3,3))\nlapply(names(teamdata.projectwise_cl)[c(-1,-2,-10)], function(x) {\n  plot(teamdata.projectwise_cl[ ,x], teamdata.projectwise_cl$date, col = teamdata.projectwise_cl$cluster, xlab = x, ylab = \"Days\", main = paste(\"Cluster distribution for\",x))\n}) \ndev.off()\n\nwrite.csv(teamdata.projectwise_cl, file = \"clusters_memberwise.csv\")\n\n# Trying HClustering\nteamdata.projectwise.dm <- dist(teamdata.projectwise[,-(1:2)])\nteamdata.projectwise.hc <- hclust(teamdata.projectwise.dm)\n\npar(mfrow= c(1,1))\npng(\"hcluster.png\", width = 4000, height = 1412)\nplot(teamdata.projectwise.hc, col = unclass(teamdata.projectwise$project))\ndev.off()\n",
    "created" : 1429471319914.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "429191128",
    "id" : "7929B4FC",
    "lastKnownWriteTime" : 1429471762,
    "path" : "~/Nikita/TeamPerformance-MachineLearning/r-workspace/KMeansClustering_MemberWise.R",
    "project_path" : "KMeansClustering_MemberWise.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}